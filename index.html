<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="ascii">
    <title>game</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --pixel-size: 7.1px;
        }
        body {
            margin: 0;
            overflow: hidden;
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            background-color: black;
            height: 100vh;
            width: 100vw;
        }
        #canvas {
            display: grid;
            gap: 0.5px;
            grid-template-columns: repeat(64, var(--pixel-size));
            grid-template-rows: repeat(64, var(--pixel-size));
            background-color: grey;
        }
        .pixel {
            width: var(--pixel-size);
            height: var(--pixel-size);
            background-color: darkgrey;
        }

    </style>
</head>
<body>
    <div id="canvas"></div>
    <script>
        const canvas = document.getElementById('canvas');
        const pixelCount = 64 * 64;
        const level = 0;
        const levels = [];

        for (let i = 0; i < pixelCount; i++) {
            const pixel = document.createElement('div');
            pixel.classList.add('pixel');
            canvas.appendChild(pixel);
        }
        fetch('game.json')
            .then(response => response.json())
            .then(data => {
                levels.push(...data);
                nextLevel();
            });

        function nextLevel() {
            for (let i = 0; i < 64; i++) {
                canvas.children[i].style.backgroundColor = 'orange';
            }
            levels[level].blocks.forEach((item) => {
                for (let i = 0; i < item.h; i++) {
                    for (let j = 0; j < item.w; j++) {
                        let index = ((item.y - 1 + i) * 4 + 1) * 64 + ((item.x - 1 + j) * 4);
                        let pixels = [
                            [
                                index,
                                index + 1,
                                index + 2,
                                index + 3
                            ],
                            [
                                index + 64,
                                index + 65,
                                index + 66,
                                index + 67
                            ],
                            [
                                index + 128,
                                index + 129,
                                index + 130,
                                index + 131
                            ],
                            [
                                index + 192,
                                index + 193,
                                index + 194,
                                index + 195
                            ]
                        ];
                        pixels.forEach((p, yindex) => {
                            p.forEach((q, xindex) => {
                                canvas.children[q].style.backgroundColor = (() => {
                                    switch (item.hard?.corner) {
                                        case 'left-top':
                                            if (i < item.hard.h && j < item.hard.w && (xindex == 1 || xindex == 2) && (yindex == 1 || yindex == 2)) {
                                                return item.type == '1' ? 'black' : 'dimgray';
                                            }
                                            break;
                                        case 'left-bottom':
                                            if (item.h - i <= item.hard.h && j < item.hard.w && (xindex == 1 || xindex == 2) && (yindex == 1 || yindex == 2)) {
                                                return item.type == '1' ? 'black' : 'dimgray';
                                            }
                                            break;
                                        case 'right-top':
                                            if (i < item.hard.h && item.w - j <= item.hard.w && (xindex == 1 || xindex == 2) && (yindex == 1 || yindex == 2)) {
                                                return item.type == '1' ? 'black' : 'dimgray';
                                            }
                                            break;
                                        case 'right-bottom':
                                            if (item.h - i <= item.hard.h && item.w - j <= item.hard.w && (xindex == 1 || xindex == 2) && (yindex == 1 || yindex == 2)) {
                                                return item.type == '1' ? 'black' : 'dimgray';
                                            }
                                            break;
                                        case undefined:
                                            break;
                                    }
                                    switch (item.type) {
                                        case '1': return 'deeppink';
                                        case '2': return 'brown';
                                        case '3': return 'yellow';
                                        case '4': return 'blue';
                                        case '5': return 'green';
                                        case '6': return 'red';
                                    }
                                })();
                            });
                        });
                    }
                }
            })
        }

        document.addEventListener('keydown', (e) => {
            switch (e.key) {
                case 'ArrowUp':
                    ;
                    break;
                case 'ArrowDown': ; break;
                case 'ArrowLeft': ; break;
                case 'ArrowRight': ; break;
            }
        });
    </script>
</body>

</html>








